import{U as T,_ as Y,W as $,e as P,c as o,d as y,w as m,a as e,H as l,b as R,o as s,R as B,D as I,X as F,Y as U,J as C,F as c,g as r,t as i,P as N,Q as j}from"./index-BNrJ-Dvj.js";import{d as E}from"./dcb-DFDBfy1j.js";import{a as L}from"./axios-B4uVmeYG.js";import{V as H,a as S}from"./VField-Cziex-qH.js";import{V as M}from"./VTable-BLQw7MbS.js";import{V as O}from"./VSelect-KAzCz1Mg.js";import"./VGrid-DeylvMMY.js";import"./index-BPvLzGhW.js";import"./VTextField-Cyw_K3aJ.js";import"./VMenu-d9ONUfxi.js";import"./createSimpleFunctional-C8sGjN9l.js";import"./VAvatar-TsXOFCQi.js";import"./VImg-Djp65FB0.js";import"./VDivider-BD2uBEGn.js";import"./VOverlay-DUP5QlJ3.js";import"./VCheckboxBtn-B0yZRWh3.js";const J=T("main",{state:()=>({dcb:"",contents:[]}),actions:{async getStatistics(h,f){const b="http://localhost:9999/payment/month";try{const n=await L.get(b,{params:{dcb:h,year:f}});this.contents=n.data.mapResult,this.dcb=h}catch{alert("작업 중 에러가 발생했습니다.")}},async exportData(h,f){const b="http://localhost:9999/payment/month/excel";try{const n=await L.get(b,{params:{dcb:h,year:f},responseType:"blob",headers:{Accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}}),_=new Date,g=_.getFullYear(),u=String(_.getMonth()+1).padStart(2,"0"),d=String(_.getDate()).padStart(2,"0"),w=String(_.getHours()).padStart(2,"0"),x=String(_.getMinutes()).padStart(2,"0"),A=String(_.getSeconds()).padStart(2,"0"),D=`${g}${u}${d}${w}${x}${A}`,p=n.headers["content-disposition"],v=p?p.split("filename=")[1]:`${h} ${g} 월별 결제 통계_${D}.xlsx`,t=new Blob([n.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),V=window.URL.createObjectURL(t),k=document.createElement("a");k.href=V,k.setAttribute("download",v),document.body.appendChild(k),k.click(),document.body.removeChild(k),window.URL.revokeObjectURL(V)}catch{alert("작업 중 에러가 발생했습니다.")}}}}),a=h=>(N("data-v-8b4e0c3f"),h=h(),j(),h),Q={class:"content-wrapper"},W=a(()=>e("br",null,null,-1)),X=["max"],q=a(()=>e("br",null,null,-1)),z={class:"table-wrapper"},G=a(()=>e("th",{class:"sticky-col"},"구분",-1)),K={class:"section-1"},Z=a(()=>e("td",{class:"sticky-col"},"결제 금액 합",-1)),tt={class:"section-1"},et=a(()=>e("td",{class:"sticky-col"},"구매 금액",-1)),st={class:"section-1"},ot=a(()=>e("td",{class:"sticky-col"},"구매 비율",-1)),nt={class:"section-1"},lt=a(()=>e("td",{class:"sticky-col"},"취소 금액",-1)),at={class:"section-1"},ct=a(()=>e("td",{class:"sticky-col"},"취소 비율",-1)),rt={class:"section-1"},it=a(()=>e("td",{class:"sticky-col"},"환불 금액",-1)),ut={class:"section-1"},dt=a(()=>e("td",{class:"sticky-col"},"환불 비율",-1)),_t={class:"section-2"},ht=a(()=>e("td",{class:"sticky-col"},"결제 건수 합",-1)),mt={class:"section-2"},pt=a(()=>e("td",{class:"sticky-col"},"구매 건수",-1)),yt={class:"section-2"},ft=a(()=>e("td",{class:"sticky-col"},"구매 건수 비율",-1)),vt={class:"section-2"},bt=a(()=>e("td",{class:"sticky-col"},"취소 건수",-1)),kt={class:"section-2"},gt=a(()=>e("td",{class:"sticky-col"},"취소 건수 비율",-1)),St={class:"section-2"},wt=a(()=>e("td",{class:"sticky-col"},"환불 건수",-1)),xt={class:"section-2"},At=a(()=>e("td",{class:"sticky-col"},"환불 건수 비율",-1)),Dt={class:"section-3"},Ct=a(()=>e("td",{class:"sticky-col"},"건당 평균 구매 금액",-1)),Vt={class:"section-3"},Pt=a(()=>e("td",{class:"sticky-col"},"건당 평균 취소 금액",-1)),Rt={class:"section-3"},Bt=a(()=>e("td",{class:"sticky-col"},"건당 평균 환불 금액",-1)),Ut={__name:"MonthlyPaymentStatistics",setup(h){const f=J(),{dcb:b,contents:n}=$(f),_=()=>new Date().getFullYear(),g=P(_());let u=P(_()),d=b;const w=()=>{if(d.value===""||d.value==null){alert("조회할 DCB를 선택해주세요.");return}if(u.value===""){alert("조회할 연도를 선택해주세요.");return}const p=_();if(u.value>p){alert("선택한 연도의 데이터가 아직 생성되지 않았습니다.");return}x()},x=async()=>{await f.getStatistics(d.value,u.value)},A=()=>{if(d.value===""||d.value==null){alert("조회할 DCB를 선택해주세요.");return}if(u.value===""){alert("조회할 달을 선택해주세요.");return}const p=_();if(u.value>p){alert("선택한 연도의 데이터가 아직 생성되지 않았습니다.");return}D()},D=async()=>{await f.exportData(d.value,u.value)};return(p,v)=>(s(),o("div",Q,[W,y(H,{align:"center",justify:"end"},{default:m(()=>[y(S,{cols:"auto"},{default:m(()=>[y(O,{class:"min-width-select",clearable:"",label:"DCB",placeholder:"DCB",items:l(E),modelValue:l(d),"onUpdate:modelValue":v[0]||(v[0]=t=>B(d)?d.value=t:d=t),variant:"outlined"},null,8,["items","modelValue"])]),_:1}),y(S,{cols:"auto"},{default:m(()=>[I(e("input",{type:"year","onUpdate:modelValue":v[1]||(v[1]=t=>B(u)?u.value=t:u=t),max:g.value},null,8,X),[[F,l(u)]])]),_:1}),y(S,{cols:"auto"},{default:m(()=>[y(U,{variant:"elevated",onClick:w},{default:m(()=>[C(" 조회 ")]),_:1})]),_:1}),y(S,{cols:"auto"},{default:m(()=>[y(U,{variant:"elevated",onClick:A},{default:m(()=>[C(" 엑셀 ")]),_:1})]),_:1})]),_:1}),q,e("div",z,[l(n).length===0?(s(),R(M,{key:0,class:"table-container"},{default:m(()=>[C(" 데이터가 없습니다. ")]),_:1})):(s(),R(M,{key:1,class:"table-container"},{default:m(()=>[e("thead",null,[e("tr",null,[G,(s(!0),o(c,null,r(l(n).statMonth,t=>(s(),o("th",null,i(t),1))),256))])]),e("tbody",null,[e("tr",K,[Z,(s(!0),o(c,null,r(l(n).totalAmount,t=>(s(),o("td",null,i(t),1))),256))]),e("tr",tt,[et,(s(!0),o(c,null,r(l(n).buyAmount,t=>(s(),o("td",null,i(t),1))),256))]),e("tr",st,[ot,(s(!0),o(c,null,r(l(n).buyAmountPercent,t=>(s(),o("td",null,i(t),1))),256))]),e("tr",nt,[lt,(s(!0),o(c,null,r(l(n).cancelAmount,t=>(s(),o("td",null,i(t),1))),256))]),e("tr",at,[ct,(s(!0),o(c,null,r(l(n).cancelAmountPercent,t=>(s(),o("td",null,i(t),1))),256))]),e("tr",rt,[it,(s(!0),o(c,null,r(l(n).refundAmount,t=>(s(),o("td",null,i(t),1))),256))]),e("tr",ut,[dt,(s(!0),o(c,null,r(l(n).refundAmountPercent,t=>(s(),o("td",null,i(t),1))),256))]),e("tr",_t,[ht,(s(!0),o(c,null,r(l(n).paymentCount,t=>(s(),o("td",null,i(t),1))),256))]),e("tr",mt,[pt,(s(!0),o(c,null,r(l(n).buyCount,t=>(s(),o("td",null,i(t),1))),256))]),e("tr",yt,[ft,(s(!0),o(c,null,r(l(n).buyCountPercent,t=>(s(),o("td",null,i(t),1))),256))]),e("tr",vt,[bt,(s(!0),o(c,null,r(l(n).cancelCount,t=>(s(),o("td",null,i(t),1))),256))]),e("tr",kt,[gt,(s(!0),o(c,null,r(l(n).cancelCountPercent,t=>(s(),o("td",null,i(t),1))),256))]),e("tr",St,[wt,(s(!0),o(c,null,r(l(n).refundCount,t=>(s(),o("td",null,i(t),1))),256))]),e("tr",xt,[At,(s(!0),o(c,null,r(l(n).refundCountPercent,t=>(s(),o("td",null,i(t),1))),256))]),e("tr",Dt,[Ct,(s(!0),o(c,null,r(l(n).buyAmountAverage,t=>(s(),o("td",null,i(t),1))),256))]),e("tr",Vt,[Pt,(s(!0),o(c,null,r(l(n).cancelAmountAverage,t=>(s(),o("td",null,i(t),1))),256))]),e("tr",Rt,[Bt,(s(!0),o(c,null,r(l(n).refundAmountAverage,t=>(s(),o("td",null,i(t),1))),256))])])]),_:1}))])]))}},qt=Y(Ut,[["__scopeId","data-v-8b4e0c3f"]]);export{qt as default};
