import{U as A,W as E,e as h,c as b,d as t,w as n,J as u,a as e,H as m,F,g as L,o as N,R as H,Y as _,t as d,f as M}from"./index-BNrJ-Dvj.js";import{a as x}from"./axios-B4uVmeYG.js";import{m as G,f as Q}from"./masking-BVJ2ul4w.js";import{V as C,a as T,b as U}from"./VCard-BJRkKJ14.js";import{V as j,a as g}from"./VField-Cziex-qH.js";import{V as k}from"./VDialog-CFwR0aSU.js";import{V as O}from"./VCardTitle-BPFYhZvz.js";import{V as i}from"./VTextField-Cyw_K3aJ.js";import{V as B}from"./VSpacer-BAKhUge0.js";import"./VAvatar-TsXOFCQi.js";import"./VImg-Djp65FB0.js";import"./index-BPvLzGhW.js";import"./VGrid-DeylvMMY.js";import"./VOverlay-DUP5QlJ3.js";import"./createSimpleFunctional-C8sGjN9l.js";const J=A("main",{state:()=>({contents:[]}),actions:{async refund(v,f,p){const c="http://localhost:9999/refund/sdcb";try{const s=await x.post(c,{dcb:v,purchaseRequestId:f,purchaseOperatorTransactionId:p});this.contents=s.data.content}catch{alert("작업 중 에러가 발생했습니다.")}},async notiRefund(v,f,p,c,s,l,o){const D="http://localhost:9999/refund/notiRefund/sdcb";try{const I=await x.post(D,{dcb:v,deviceId:f,prchsId:p,prchsDt:c,cancelDt:s,requestId:l,purchaseOperatorTransactionId:o});this.contents=I.data.content}catch{alert("작업 중 에러가 발생했습니다.")}}}}),W={class:"content-wrapper"},Y=e("br",null,null,-1),z=e("b",null,"※ 취소 전 주의사항",-1),K=e("br",null,null,-1),X=e("br",null,null,-1),Z=e("br",null,null,-1),$=e("br",null,null,-1),ee=e("br",null,null,-1),le=e("br",null,null,-1),te=e("b",null,[e("u",null,[u("4. 취소 전 사업 팀과 개발 PM에 정말 취소하는 것인지 확인한다. "),e("br"),u(" 5. “취소 Noti 요청”의 경우 실제 Noti API와는 달리 MMS는 전송되지 않는다 ."),e("br"),u(" 6. 테스트 폰의 경우 SDCB 취소 상태만 업데이트된다. (한도 및 유큐브 연동 제외)")])],-1),ae=e("br",null,null,-1),ue=e("br",null,null,-1),ne=e("br",null,null,-1),re={class:"table-container"},oe=e("thead",null,[e("tr",null,[e("th",null,"request_id"),e("th",null,"partition_id"),e("th",null,"status"),e("th",null,"ctn"),e("th",null,"purchase_dt"),e("th",null,"total_price"),e("th",null,"cancel_dt"),e("th",null,"cancel_code"),e("th",null,"cancel_msg")])],-1),de={key:0},se=e("td",{colspan:"9",style:{"text-align":"center"}},"데이터가 없습니다.",-1),ie=[se],ce={class:"masked"},fe={class:"original"},pe=e("br",null,null,-1),_e=e("br",null,null,-1),he=e("br",null,null,-1),me=e("br",null,null,-1),ve=e("br",null,null,-1),Ie=e("br",null,null,-1),Ve=e("br",null,null,-1),be=e("br",null,null,-1),Ne=e("br",null,null,-1),De=e("br",null,null,-1),Fe={__name:"Refund-SDCB",setup(v){const f=J(),{contents:p}=E(f),c=h(!1),s=h(!1),l=h({selectedDcb:h(""),refund:{purchaseRequestId:"",purchaseOperatorTransactionId:""},refundNoti:{deviceId:"",prchsId:"",prchsDt:"",cancelDt:"",requestId:"",purchaseOperatorTransactionId:""}});let o=h("SDCB");const D=()=>{q(),c.value=!0},I=()=>{q(),s.value=!0},V=()=>{c.value=!1,s.value=!1},q=()=>{l.value.refund.purchaseRequestId="",l.value.refund.purchaseOperatorTransactionId="",l.value.refundNoti.deviceId="",l.value.refundNoti.prchsId="",l.value.refundNoti.prchsDt="",l.value.refundNoti.cancelDt="",l.value.refundNoti.requestId="",l.value.refundNoti.purchaseOperatorTransactionId=""},S=()=>{P()&&(f.refund(o.value,l.value.refund.purchaseRequestId,l.value.refund.purchaseOperatorTransactionId),V())},y=()=>{w()&&(f.notiRefund(o.value,l.value.refundNoti.deviceId,l.value.refundNoti.prchsId,l.value.refundNoti.prchsDt,l.value.refundNoti.cancelDt,l.value.refundNoti.requestId,l.value.refundNoti.purchaseOperatorTransactionId),V())},P=()=>o.value===""||o.value===null?(alert("DCB를 선택해주세요."),!1):l.value.refund.purchaseRequestId.trim().length===0?(alert("purchaseRequestId 값을 입력해주세요."),!1):l.value.refund.purchaseOperatorTransactionId.trim().length===0?(alert("purchaseOperatorTransactionId 값을 입력해주세요."),!1):!0,w=()=>o.value===""||o.value===null?(alert("DCB를 선택해주세요."),!1):l.value.refundNoti.deviceId.trim().length===0?(alert("deviceId 값을 입력해주세요."),!1):l.value.refundNoti.prchsId.trim().length===0?(alert("prchsId 값을 입력해주세요."),!1):l.value.refundNoti.prchsDt.trim().length===0?(alert("prchsDt 값을 입력해주세요."),!1):l.value.refundNoti.cancelDt.trim().length===0?(alert("cancelDt 값을 입력해주세요."),!1):l.value.refundNoti.requestId.trim().length===0?(alert("requestId 값을 입력해주세요."),!1):l.value.refundNoti.purchaseOperatorTransactionId.trim().length===0?(alert("purchaseOperatorTransactionId 값을 입력해주세요."),!1):!0;return(Re,r)=>{const R=M("font");return N(),b("div",W,[Y,t(C,{class:"p-4 mb-4",outlined:""},{default:n(()=>[t(O,{class:"text-h6"},{default:n(()=>[z]),_:1}),t(T,null,{default:n(()=>[e("p",null,[e("b",null,[e("u",null,[t(R,{color:"red"},{default:n(()=>[u("1. 청소년 요금제 구매 건은 한도 복원 불가하다. (한도 측에 요청해야 한다.)")]),_:1})])]),K,t(R,{color:"blue"},{default:n(()=>[u("2. DB 확인 : SDCB DB에서 해당 REQUEST_ID를 조회하여 구매 상태인지 여부와 어느 단계에서 취소 요청이 누락되었는지 확인한다."),X,u("   → TB_PURCHASE_INFO 와 TB_NOTI_PURCHASE 의 상태가 모두 “구매” 상태이면, “취소 요청”과 “취소 Noti 요청”을 모두 실행해야 한다."),Z,u("   → TB_NOTI_PURCHASE 의 상태만 “구매” 상태라면, “취소 Noti 요청”만 하면 된다."),$,u(" 3. LOG 확인 : SDCB LOG에서 해당 REQUEST_ID를 조회하여 어느 단계에서 취소 요청이 누락되었는지 확인한다."),ee,u("   →CancelNotification API 로그와 SendPurchaseNoti API 로그가 있는지 확인한다.")]),_:1}),le,t(R,{color:"red"},{default:n(()=>[te]),_:1})])]),_:1})]),_:1}),ae,u(),ue,t(j,{align:"center",justify:"end"},{default:n(()=>[t(g,{cols:"auto"},{default:n(()=>[t(i,{class:"min-width-select",label:"DCB",modelValue:m(o),"onUpdate:modelValue":r[0]||(r[0]=a=>H(o)?o.value=a:o=a),variant:"outlined",readonly:""},null,8,["modelValue"])]),_:1}),t(g,{cols:"auto"},{default:n(()=>[t(_,{variant:"elevated",onClick:D},{default:n(()=>[u(" 취소 요청 ")]),_:1})]),_:1}),t(g,{cols:"auto"},{default:n(()=>[t(_,{variant:"elevated",onClick:I},{default:n(()=>[u(" 취소 Noti 요청 ")]),_:1})]),_:1})]),_:1}),ne,e("div",re,[e("div",null,[e("table",null,[oe,e("tbody",null,[m(p).length===0?(N(),b("tr",de,ie)):(N(!0),b(F,{key:1},L(m(p),a=>(N(),b("tr",{key:a.requestId},[e("td",null,d(a.requestId),1),e("td",null,d(a.partitionId),1),e("td",null,d(a.status),1),e("td",null,[e("span",ce,d(m(G)(a.ctn)),1),e("span",fe,d(m(Q)(a.ctn)),1)]),e("td",null,d(a.purchaseDt),1),e("td",null,d(a.totalPrice),1),e("td",null,d(a.cancelDt),1),e("td",null,d(a.cancelCode),1),e("td",null,d(a.cancelMsg),1)]))),128))])]),t(k,{modelValue:c.value,"onUpdate:modelValue":r[3]||(r[3]=a=>c.value=a),"max-width":"600px"},{default:n(()=>[t(C,null,{default:n(()=>[t(O,{class:"text-h5"},{default:n(()=>[u("취소 요청")]),_:1}),u(),pe,t(T,null,{default:n(()=>[t(i,{label:"purchaseRequestId",modelValue:l.value.refund.purchaseRequestId,"onUpdate:modelValue":r[1]||(r[1]=a=>l.value.refund.purchaseRequestId=a)},null,8,["modelValue"]),u(),_e,t(i,{label:"purchaseOperatorTransactionId",modelValue:l.value.refund.purchaseOperatorTransactionId,"onUpdate:modelValue":r[2]||(r[2]=a=>l.value.refund.purchaseOperatorTransactionId=a)},null,8,["modelValue"]),u(),he]),_:1}),t(U,null,{default:n(()=>[t(B),t(_,{color:"blue darken-1",variant:"outlined",text:"",onClick:V},{default:n(()=>[u("취소")]),_:1}),t(_,{color:"blue darken-1",variant:"outlined",text:"",onClick:S},{default:n(()=>[u("요청")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(k,{modelValue:s.value,"onUpdate:modelValue":r[10]||(r[10]=a=>s.value=a),"max-width":"600px"},{default:n(()=>[t(C,null,{default:n(()=>[t(O,{class:"text-h5"},{default:n(()=>[u("취소 Noti 요청")]),_:1}),u(),me,t(T,null,{default:n(()=>[t(i,{label:"deviceId",modelValue:l.value.refundNoti.deviceId,"onUpdate:modelValue":r[4]||(r[4]=a=>l.value.refundNoti.deviceId=a)},null,8,["modelValue"]),u(),ve,t(i,{label:"prchsId",modelValue:l.value.refundNoti.prchsId,"onUpdate:modelValue":r[5]||(r[5]=a=>l.value.refundNoti.prchsId=a)},null,8,["modelValue"]),u(),Ie,t(i,{label:"prchsDt",modelValue:l.value.refundNoti.prchsDt,"onUpdate:modelValue":r[6]||(r[6]=a=>l.value.refundNoti.prchsDt=a)},null,8,["modelValue"]),u(),Ve,t(i,{label:"cancelDt",modelValue:l.value.refundNoti.cancelDt,"onUpdate:modelValue":r[7]||(r[7]=a=>l.value.refundNoti.cancelDt=a)},null,8,["modelValue"]),u(),be,t(i,{label:"requestId",modelValue:l.value.refundNoti.requestId,"onUpdate:modelValue":r[8]||(r[8]=a=>l.value.refundNoti.requestId=a)},null,8,["modelValue"]),u(),Ne,t(i,{label:"purchaseOperatorTransactionId",modelValue:l.value.refundNoti.purchaseOperatorTransactionId,"onUpdate:modelValue":r[9]||(r[9]=a=>l.value.refundNoti.purchaseOperatorTransactionId=a)},null,8,["modelValue"]),u(),De]),_:1}),t(U,null,{default:n(()=>[t(B),t(_,{color:"blue darken-1",variant:"outlined",text:"",onClick:V},{default:n(()=>[u("취소")]),_:1}),t(_,{color:"blue darken-1",variant:"outlined",text:"",onClick:y},{default:n(()=>[u("요청")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])])])}}};export{Fe as default};
