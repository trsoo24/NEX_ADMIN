import{U as N,W as $,e as V,c as s,d as D,w as h,H as o,b as T,a as e,o as n,R as B,D as U,X as k,Y as O,J as P,F as a,g as r,t as u}from"./index-BNrJ-Dvj.js";import{a as E}from"./axios-B4uVmeYG.js";import{d as I}from"./dcb-DFDBfy1j.js";import{V as M,a as C}from"./VField-Cziex-qH.js";import{V as L}from"./VTable-BLQw7MbS.js";import{V as z}from"./VSelect-KAzCz1Mg.js";import"./VGrid-DeylvMMY.js";import"./index-BPvLzGhW.js";import"./VTextField-Cyw_K3aJ.js";import"./VMenu-d9ONUfxi.js";import"./createSimpleFunctional-C8sGjN9l.js";import"./VAvatar-TsXOFCQi.js";import"./VImg-Djp65FB0.js";import"./VDivider-BD2uBEGn.js";import"./VOverlay-DUP5QlJ3.js";import"./VCheckboxBtn-B0yZRWh3.js";const j=N("main",{state:()=>({dcb:"",contents:[]}),actions:{async getContents(g,f,y){const l="http://localhost:9999/analyze/purchase";try{const _=await E.get(l,{params:{dcb:g,startDate:f,endDate:y}});this.contents=_.data.responsePage.content,this.dcb=g}catch{alert("작업 중 에러가 발생했습니다.")}},async exportData(g,f,y){const l="http://localhost:9999/analyze/purchase/excel";try{const _=await E.get(l,{params:{dcb:g,startDate:f,endDate:y},responseType:"blob",headers:{Accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}}),v=new Date,A=v.getFullYear(),S=String(v.getMonth()+1).padStart(2,"0"),R=String(v.getDate()).padStart(2,"0"),x=String(v.getHours()).padStart(2,"0"),p=String(v.getMinutes()).padStart(2,"0"),c=String(v.getSeconds()).padStart(2,"0"),m=`${A}${S}${R}${x}${p}${c}`,b=_.headers["content-disposition"],d=b?b.split("filename=")[1]:`${g} ${f}~${y} 결제 통계 분석_${m}.xlsx`,i=new Blob([_.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),t=window.URL.createObjectURL(i),w=document.createElement("a");w.href=t,w.setAttribute("download",d),document.body.appendChild(w),w.click(),document.body.removeChild(w),window.URL.revokeObjectURL(t)}catch(_){console.error(_),alert("작업 중 에러가 발생했습니다.")}}}}),F={class:"content-wrapper"},Y=e("br",null,null,-1),G=["max"],H=["min","max"],J=e("br",null,null,-1),W=e("th",null,"구분",-1),X={class:"section-1"},q=e("td",null,"결제 시도 수",-1),K={class:"section-1"},Q=e("td",null,"성공 수",-1),Z={class:"section-1"},tt=e("td",null,"실패 수",-1),et={class:"section-1"},nt=e("td",null,"> 잔여 한도 부족",-1),st={class:"section-1"},ot=e("td",null,"> 청소년 요금제 잔여 한도 부족",-1),lt={class:"section-1"},at=e("td",null,"> 7등급 차단",-1),rt={class:"section-1"},ut=e("td",null,"> 차단 요금제",-1),ct={class:"section-2"},dt=e("td",null,"> MVNO 차단",-1),it={class:"section-2"},_t=e("td",null,"> 고객 정보 없음",-1),mt={class:"section-2"},pt=e("td",null,"> 듀얼 넘버 차단",-1),ht={class:"section-3"},ft=e("td",null,"> 만 14세 미만 차단",-1),yt={class:"section-3"},vt=e("td",null,"> 법인폰 차단",-1),Dt={class:"section-3"},gt=e("td",null,"> 분실폰 차단",-1),bt={class:"section-2"},wt=e("td",null,"> NCAS TIMEOUT",-1),Ct={class:"section-2"},At=e("td",null,"> NCAS ERROR",-1),St={class:"section-2"},Rt=e("td",null,"> RBP ERROR",-1),xt={class:"section-2"},Vt=e("td",null,"> RCSG ERROR",-1),Gt={__name:"PurcahseAnalyze",setup(g){const f=j(),{dcb:y,contents:l}=$(f),_=()=>{const d=new Date,i=new Date(d);return i.setDate(d.getDate()-1),i.toISOString().split("T")[0]},v=(d,i=31)=>{const t=new Date(d);return t.setDate(t.getDate()-i),t.toISOString().split("T")[0]},A=()=>{if(p.value===""||p.value===null)return alert("DCB를 선택해주세요."),!1;if(c.value===""||m.value===""){alert("조회할 날짜를 모두 선택해주세요.");return}const d=new Date(_());if(new Date(c.value)>d||new Date(m.value)>d){alert("선택한 날의 데이터가 아직 생성되지 않았습니다.");return}S()},S=()=>{f.getContents(p.value,c.value,m.value)},R=()=>{if(y.value===""||y.value==null){alert("조회할 DCB를 선택해주세요.");return}if(c.value===""||m.value===""){alert("조회할 날짜를 모두 선택해주세요.");return}const d=new Date(getToday());if(new Date(c.value)>d||new Date(m.value)>d){alert("선택한 날의 데이터가 아직 생성되지 않았습니다.");return}x()},x=()=>{f.exportData(p.value,c.value,m.value)};let p=y,c=V(v(_())),m=V(_()),b=V(_());return(d,i)=>(n(),s("div",F,[Y,D(M,{align:"center",justify:"end"},{default:h(()=>[D(C,{cols:"auto"},{default:h(()=>[D(z,{class:"min-width-select",clearable:"",label:"DCB",placeholder:"DCB",items:o(I),modelValue:o(p),"onUpdate:modelValue":i[0]||(i[0]=t=>B(p)?p.value=t:p=t),variant:"outlined"},null,8,["items","modelValue"])]),_:1}),D(C,{cols:"auto"},{default:h(()=>[U(e("input",{type:"date","onUpdate:modelValue":i[1]||(i[1]=t=>B(c)?c.value=t:c=t),max:o(b)},null,8,G),[[k,o(c)]]),U(e("input",{type:"date","onUpdate:modelValue":i[2]||(i[2]=t=>B(m)?m.value=t:m=t),min:o(c),max:o(b)},null,8,H),[[k,o(m)]])]),_:1}),D(C,{cols:"auto"},{default:h(()=>[D(O,{variant:"elevated",onClick:A},{default:h(()=>[P(" 조회 ")]),_:1})]),_:1}),D(C,{cols:"auto"},{default:h(()=>[D(O,{variant:"elevated",onClick:R},{default:h(()=>[P(" 엑셀 ")]),_:1})]),_:1})]),_:1}),J,o(l).length===0?(n(),T(L,{key:0,class:"table-container"},{default:h(()=>[P(" 데이터가 없습니다. ")]),_:1})):(n(),T(L,{key:1,class:"table-container"},{default:h(()=>[e("thead",null,[e("tr",null,[W,(n(!0),s(a,null,r(o(l).statDay,t=>(n(),s("th",null,u(t),1))),256))])]),e("tbody",null,[e("tr",X,[q,(n(!0),s(a,null,r(o(l).totalAmount,t=>(n(),s("td",null,u(t),1))),256))]),e("tr",K,[Q,(n(!0),s(a,null,r(o(l).buyAmount,t=>(n(),s("td",null,u(t),1))),256))]),e("tr",Z,[tt,(n(!0),s(a,null,r(o(l).buyAmountPercent,t=>(n(),s("td",null,u(t),1))),256))]),e("tr",et,[nt,(n(!0),s(a,null,r(o(l).cancelAmount,t=>(n(),s("td",null,u(t),1))),256))]),e("tr",st,[ot,(n(!0),s(a,null,r(o(l).cancelAmountPercent,t=>(n(),s("td",null,u(t),1))),256))]),e("tr",lt,[at,(n(!0),s(a,null,r(o(l).refundAmount,t=>(n(),s("td",null,u(t),1))),256))]),e("tr",rt,[ut,(n(!0),s(a,null,r(o(l).refundAmountPercent,t=>(n(),s("td",null,u(t),1))),256))]),e("tr",ct,[dt,(n(!0),s(a,null,r(o(l).paymentCount,t=>(n(),s("td",null,u(t),1))),256))]),e("tr",it,[_t,(n(!0),s(a,null,r(o(l).refundCount,t=>(n(),s("td",null,u(t),1))),256))]),e("tr",mt,[pt,(n(!0),s(a,null,r(o(l).refundCountPercent,t=>(n(),s("td",null,u(t),1))),256))]),e("tr",ht,[ft,(n(!0),s(a,null,r(o(l).buyAmountAverage,t=>(n(),s("td",null,u(t),1))),256))]),e("tr",yt,[vt,(n(!0),s(a,null,r(o(l).cancelAmountAverage,t=>(n(),s("td",null,u(t),1))),256))]),e("tr",Dt,[gt,(n(!0),s(a,null,r(o(l).refundAmountAverage,t=>(n(),s("td",null,u(t),1))),256))]),e("tr",bt,[wt,(n(!0),s(a,null,r(o(l).buyCount,t=>(n(),s("td",null,u(t),1))),256))]),e("tr",Ct,[At,(n(!0),s(a,null,r(o(l).buyCountPercent,t=>(n(),s("td",null,u(t),1))),256))]),e("tr",St,[Rt,(n(!0),s(a,null,r(o(l).cancelCount,t=>(n(),s("td",null,u(t),1))),256))]),e("tr",xt,[Vt,(n(!0),s(a,null,r(o(l).cancelCountPercent,t=>(n(),s("td",null,u(t),1))),256))])])]),_:1}))]))}};export{Gt as default};
