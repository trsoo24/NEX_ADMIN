import{U as J,W,$ as z,e as j,c,d as n,w as d,a as e,o as m,H as l,R as A,D as X,X as q,Y as E,J as T,F as B,g as R,t as f,n as K}from"./index-B8EbGMN3.js";import{a as I}from"./axios-B4uVmeYG.js";import{d as Q}from"./dcb-DFDBfy1j.js";import{V as N,a as w}from"./VInput-msPG-MP_.js";import{V as Z}from"./VTable-QS9nLRnj.js";import{V as tt}from"./VSelect-CZOfT56l.js";import{V as et}from"./VTextField-Ujn_yGZZ.js";import"./VGrid-D8xKyB2U.js";import"./transition-h0L7ZsHG.js";import"./forwardRefs-DWGaNmQL.js";import"./VMenu-BRgnxf6I.js";import"./createSimpleFunctional-DwNSd_ti.js";import"./VAvatar-IsnjnCc2.js";import"./VImg-BNBQc3z5.js";import"./index-Qv1F-OC0.js";import"./VDivider-DJKyB90Z.js";import"./VOverlay-ColyBhV7.js";import"./VCheckboxBtn-BDq1Ohb6.js";import"./VField-8s2H7kOf.js";const at=J("main",{state:()=>({dcb:"",keyword:"",contents:[],total:"",pageSize:10,currentPage:1}),actions:{async getContents(D,h,_,S=1){const v="http://localhost:8080/product/day";try{const o=await I.get(v,{params:{dcb:D,month:h,itemName:_,page:S,pageSize:this.pageSize}});this.contents=o.data.responsePage.content,this.total=o.data.responsePage.totalElements,this.currentPage=o.data.responsePage.number+1,this.dcb=D,this.keyword=_}catch{alert("작업 중 에러가 발생했습니다.")}},async exportData(D,h,_){const S="http://localhost:8080/product/day/excel";try{const v=await I.get(S,{params:{dcb:D,month:h,itemName:_},responseType:"blob",headers:{Accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}}),o=new Date,V=o.getFullYear(),s=String(o.getMonth()+1).padStart(2,"0"),g=String(o.getDate()).padStart(2,"0"),x=String(o.getHours()).padStart(2,"0"),U=String(o.getMinutes()).padStart(2,"0"),$=String(o.getSeconds()).padStart(2,"0"),F=`${V}${s}${g}${x}${U}${$}`,P=v.headers["content-disposition"],C=P?P.split("filename=")[1]:`${D} ${s} 상품 일별 목록_${F}.xlsx`,L=new Blob([v.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),M=window.URL.createObjectURL(L),y=document.createElement("a");y.href=M,y.setAttribute("download",C),document.body.appendChild(y),y.click(),document.body.removeChild(y),window.URL.revokeObjectURL(M)}catch{alert("작업 중 에러가 발생했습니다.")}}}}),ot={class:"content-wrapper"},lt=e("br",null,null,-1),nt=["max"],st=e("br",null,null,-1),rt=e("th",null,"번호",-1),it=e("th",null,"판매자명",-1),ut=e("th",null,"상품명",-1),dt=e("th",null,"Total",-1),ct=e("th",null,"비율",-1),mt={key:0},pt=e("td",{colspan:"36",style:{"text-align":"center"}},"데이터가 없습니다.",-1),ht=[pt],_t={class:"pagination"},vt=e("br",null,null,-1),ft=e("br",null,null,-1),gt=["disabled"],yt=e("b",null,"이전",-1),Dt=[yt],bt=["onClick"],wt=["disabled"],St=e("b",null,"다음",-1),xt=[St],Ht={__name:"ProductByDay",setup(D){const h=at(),{dcb:_,keyword:S,contents:v,total:o,pageSize:V,currentPage:s}=W(h),g=z(()=>o.value?Math.ceil(o.value/V.value):0),x=a=>{if(u.value===""||u.value===null)return alert("DCB를 선택해주세요."),!1;a>=1&&a<=g.value&&h.getContents(u.value,p.value,i.value,a)},U=()=>{s.value>1&&x(s.value-1)},$=()=>{s.value<g.value&&x(s.value+1)},F=()=>new Date().getFullYear(),P=()=>String(new Date().getMonth()+1).padStart(2,"0"),C=()=>{const a=new Date,r=a.getFullYear(),t=String(a.getMonth()+1).padStart(2,"0");return`${r}-${t}`},L=(a,r)=>{const t=new Date(a,r,0),k=[];for(let b=1;b<=t.getDate();b++)k.push(String(b).padStart(2,"0"));return k},M=()=>{if(u.value===""||u.value===null)return alert("DCB를 선택해주세요."),!1;if(p.value===""){alert("조회할 달을 선택해주세요.");return}const a=C();if(p.value>a){alert("선택한 달의 데이터가 아직 생성되지 않았습니다.");return}i.value.trim().length===0&&(i.value=""),y()},y=()=>{h.getContents(u.value,p.value,i.value,s.value)},H=()=>{if(_.value===""||_.value==null){alert("조회할 DCB를 선택해주세요.");return}if(startDate.value===""||endDate.value===""){alert("조회할 날짜를 모두 선택해주세요.");return}const a=new Date(getToday());if(new Date(startDate.value)>a||new Date(endDate.value)>a){alert("선택한 날의 데이터가 아직 생성되지 않았습니다.");return}i.value.trim().length===0&&(i.value=""),O()},O=()=>{h.exportData(u.value,p.value,i.value)};let i=S,u=_,p=j(C()),G=j(C()),Y=z(()=>{let a=F(),r=P();return L(a,r)});return(a,r)=>(m(),c("div",ot,[lt,n(N,{align:"center",justify:"end"},{default:d(()=>[n(w,{cols:"auto"},{default:d(()=>[n(tt,{class:"min-width-select",clearable:"",label:"DCB",placeholder:"DCB",items:l(Q),modelValue:l(u),"onUpdate:modelValue":r[0]||(r[0]=t=>A(u)?u.value=t:u=t),variant:"outlined"},null,8,["items","modelValue"])]),_:1}),n(w,{cols:"auto"},{default:d(()=>[X(e("input",{type:"month","onUpdate:modelValue":r[1]||(r[1]=t=>A(p)?p.value=t:p=t),max:l(G)},null,8,nt),[[q,l(p)]])]),_:1}),n(w,{cols:"auto"},{default:d(()=>[n(et,{class:"min-width-input",modelValue:l(i),"onUpdate:modelValue":r[2]||(r[2]=t=>A(i)?i.value=t:i=t),label:"상품명",variant:"outlined"},null,8,["modelValue"])]),_:1}),n(w,{cols:"auto"},{default:d(()=>[n(E,{variant:"elevated",onClick:M},{default:d(()=>[T(" 조회 ")]),_:1})]),_:1}),n(w,{cols:"auto"},{default:d(()=>[n(E,{variant:"elevated",onClick:H},{default:d(()=>[T(" 엑셀 ")]),_:1})]),_:1})]),_:1}),st,n(Z,{class:"table-container"},{default:d(()=>[e("div",null,[e("table",null,[e("thead",null,[e("tr",null,[rt,it,ut,dt,ct,(m(!0),c(B,null,R(l(Y),t=>(m(),c("th",{key:t},f(t)+"일",1))),128))])]),e("tbody",null,[l(v).length===0?(m(),c("tr",mt,ht)):(m(!0),c(B,{key:1},R(l(v),(t,k)=>(m(),c("tr",{key:t.itemsalesNm},[e("td",null,f((l(s)-1)*l(V)+k+1),1),e("td",null,f(t.merchantName),1),e("td",null,f(t.itemName),1),e("td",null,f(t.total),1),e("td",null,f(t.percent),1),(m(!0),c(B,null,R(l(Y),b=>(m(),c("td",{key:b},f(t.dailySales[b-1]||0),1))),128))]))),128))])]),e("div",_t,[vt,ft,n(N,{align:"center",justify:"center"},{default:d(()=>[n(w,{cols:"auto"},{default:d(()=>[e("button",{onClick:U,disabled:l(s)===1},Dt,8,gt),T("   "),(m(!0),c(B,null,R(g.value,t=>(m(),c("button",{key:t,onClick:k=>x(t),class:K({active:t===l(s)})},f(t),11,bt))),128)),T("   "),e("button",{onClick:$,disabled:l(s)===g.value||g.value<1},xt,8,wt)]),_:1})]),_:1})])])]),_:1})]))}};export{Ht as default};
