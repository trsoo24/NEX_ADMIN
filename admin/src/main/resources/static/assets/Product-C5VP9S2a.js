import{U as Y,W as G,$ as J,e as A,c as b,d as r,w as p,a as t,H as l,F as E,g as F,o as w,R as P,D as I,X as M,Y as O,J as B,t as C,n as W}from"./index-BNrJ-Dvj.js";import{a as N}from"./axios-B4uVmeYG.js";import{d as X}from"./dcb-DFDBfy1j.js";import{V as H,a as x}from"./VField-Cziex-qH.js";import{V as q}from"./VSelect-KAzCz1Mg.js";import{V as K}from"./VTextField-Cyw_K3aJ.js";import"./VGrid-DeylvMMY.js";import"./index-BPvLzGhW.js";import"./VMenu-d9ONUfxi.js";import"./createSimpleFunctional-C8sGjN9l.js";import"./VAvatar-TsXOFCQi.js";import"./VImg-Djp65FB0.js";import"./VDivider-BD2uBEGn.js";import"./VOverlay-DUP5QlJ3.js";import"./VCheckboxBtn-B0yZRWh3.js";const Q=Y("main",{state:()=>({dcb:"",keyword:"",contents:[],total:"",pageSize:10,currentPage:1}),actions:{async getContents(f,m,_,g,y=1){const v="http://localhost:9999/product";try{const o=await N.get(v,{params:{dcb:f,startDate:m,endDate:_,productName:g,page:y,pageSize:this.pageSize}});this.contents=o.data.responsePage.content,this.total=o.data.responsePage.totalElements,this.currentPage=o.data.responsePage.number+1,this.dcb=f,this.keyword=g}catch{alert("작업 중 에러가 발생했습니다.")}},async exportData(f,m,_,g){const y="http://localhost:9999/product/excel";try{const v=await N.get(y,{params:{dcb:f,startDate:m,endDate:_,productName:g},responseType:"blob",headers:{Accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}}),o=new Date,i=o.getFullYear(),h=String(o.getMonth()+1).padStart(2,"0"),S=String(o.getDate()).padStart(2,"0"),U=String(o.getHours()).padStart(2,"0"),R=String(o.getMinutes()).padStart(2,"0"),D=String(o.getSeconds()).padStart(2,"0"),T=`${i}${h}${S}${U}${R}${D}`,V=v.headers["content-disposition"],$=V?V.split("filename=")[1]:`${f} ${m}~${_} 상품 목록_${T}.xlsx`,L=new Blob([v.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),k=window.URL.createObjectURL(L),a=document.createElement("a");a.href=k,a.setAttribute("download",$),document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(k)}catch(v){console.error(v),alert("작업 중 에러가 발생했습니다.")}}}}),Z={class:"content-wrapper"},tt=t("br",null,null,-1),et=["max"],at=["min","max"],lt=t("br",null,null,-1),ot={class:"table-container"},nt=t("thead",null,[t("tr",null,[t("th",null,"번호"),t("th",null,"상품명"),t("th",null,"판매자명"),t("th",null,"최종 결제일")])],-1),st={key:0},rt=t("td",{colspan:"5",style:{"text-align":"center"}},"데이터가 없습니다.",-1),it=[rt],ut={class:"pagination"},dt=t("br",null,null,-1),ct=t("br",null,null,-1),pt=["disabled"],mt=t("b",null,"이전",-1),vt=[mt],_t=["onClick"],ht=["disabled"],ft=t("b",null,"다음",-1),gt=[ft],Lt={__name:"Product",setup(f){const m=Q(),{dcb:_,keyword:g,contents:y,total:v,pageSize:o,currentPage:i}=G(m),h=J(()=>v.value?Math.ceil(v.value/o.value):0),S=n=>{if(u.value===""||u.value===null)return alert("DCB를 선택해주세요."),!1;n>=1&&n<=h.value&&m.getContents(u.value,s.value,d.value,a.value,n)},U=()=>{i.value>1&&S(i.value-1)},R=()=>{i.value<h.value&&S(i.value+1)},D=()=>new Date().toISOString().split("T")[0],T=(n,c=31)=>{const e=new Date(n);return e.setDate(e.getDate()-c),e.toISOString().split("T")[0]},V=()=>{if(u.value===""||u.value===null)return alert("DCB를 선택해주세요."),!1;if(s.value===""||d.value===""){alert("조회할 날짜를 모두 선택해주세요.");return}const n=new Date(D());if(new Date(s.value)>n||new Date(d.value)>n){alert("선택한 날의 데이터가 아직 생성되지 않았습니다.");return}a.value.trim().length===0&&(a.value=""),$()},$=()=>{m.getContents(u.value,s.value,d.value,a.value,i.value)},L=()=>{if(_.value===""||_.value==null){alert("조회할 DCB를 선택해주세요.");return}if(s.value===""||d.value===""){alert("조회할 날짜를 모두 선택해주세요.");return}const n=new Date(D());if(new Date(s.value)>n||new Date(d.value)>n){alert("선택한 날의 데이터가 아직 생성되지 않았습니다.");return}a.value.trim().length===0&&(a.value=""),k()},k=()=>{m.exportData(u.value,s.value,d.value,a.value)};let a=g,u=_,s=A(T(new Date)),d=A(D()),z=A(D());return(n,c)=>(w(),b("div",Z,[tt,r(H,{align:"center",justify:"end"},{default:p(()=>[r(x,{cols:"auto"},{default:p(()=>[r(q,{class:"min-width-select",clearable:"",label:"DCB",placeholder:"DCB",items:l(X),modelValue:l(u),"onUpdate:modelValue":c[0]||(c[0]=e=>P(u)?u.value=e:u=e),variant:"outlined"},null,8,["items","modelValue"])]),_:1}),r(x,{cols:"auto"},{default:p(()=>[I(t("input",{type:"date","onUpdate:modelValue":c[1]||(c[1]=e=>P(s)?s.value=e:s=e),max:l(z)},null,8,et),[[M,l(s)]]),I(t("input",{type:"date","onUpdate:modelValue":c[2]||(c[2]=e=>P(d)?d.value=e:d=e),min:l(s),max:l(z)},null,8,at),[[M,l(d)]])]),_:1}),r(x,{cols:"auto"},{default:p(()=>[r(K,{class:"min-width-input",modelValue:l(a),"onUpdate:modelValue":c[3]||(c[3]=e=>P(a)?a.value=e:a=e),label:"상품명",variant:"outlined"},null,8,["modelValue"])]),_:1}),r(x,{cols:"auto"},{default:p(()=>[r(O,{variant:"elevated",onClick:V},{default:p(()=>[B(" 조회 ")]),_:1})]),_:1}),r(x,{cols:"auto"},{default:p(()=>[r(O,{variant:"elevated",onClick:L},{default:p(()=>[B(" 엑셀 ")]),_:1})]),_:1})]),_:1}),lt,t("div",ot,[t("div",null,[t("table",null,[nt,t("tbody",null,[l(y).length===0?(w(),b("tr",st,it)):(w(!0),b(E,{key:1},F(l(y),(e,j)=>(w(),b("tr",{key:e.productName},[t("td",null,C((l(i)-1)*l(o)+j+1),1),t("td",null,C(e.productName),1),t("td",null,C(e.sellerCompany),1),t("td",null,C(e.stdDt),1)]))),128))])]),t("div",ut,[dt,ct,r(H,{align:"center",justify:"center"},{default:p(()=>[r(x,{cols:"auto"},{default:p(()=>[t("button",{onClick:U,disabled:l(i)===1},vt,8,pt),B("   "),(w(!0),b(E,null,F(h.value,e=>(w(),b("button",{key:e,onClick:j=>S(e),class:W({active:e===l(i)})},C(e),11,_t))),128)),B("   "),t("button",{onClick:R,disabled:l(i)===h.value||h.value<1},gt,8,ht)]),_:1})]),_:1})])])])]))}};export{Lt as default};
