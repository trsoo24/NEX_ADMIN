import{U as j,_ as F,W as N,e as R,c as a,d as b,w as c,a as t,H as u,b as B,o as e,F as i,g as A,R as U,D as E,X as H,Y as L,J as x,t as C,n as M,h as O,P as z,Q as J}from"./index-Cl5wPPhe.js";import{d as T}from"./dcb-DFDBfy1j.js";import{a as Y}from"./axios-B4uVmeYG.js";import{V as Q,a as S}from"./VInput-BUIgaqBY.js";import{V as $}from"./VTable-k-LXP69-.js";import{V as W}from"./VCheckbox-CPRIYXw-.js";import"./VGrid-CcRiOlXM.js";import"./transition-D5l4heR3.js";import"./VCheckboxBtn-CE1nV8AX.js";const X=j("main",{state:()=>({contents:[]}),actions:{async getStatistics(y,g){const s="http://192.168.10.31:8080/payment/month";try{const d=y.join(","),m=await Y.get(s,{params:{dcbs:d,year:g}});this.contents=m.data.mapResult}catch{alert("작업 중 에러가 발생했습니다.")}},async exportData(y,g){const s="http://192.168.10.31:8080/payment/month/excel";try{const d=y.join(","),m=await Y.get(s,{params:{dcbs:d,year:g},responseType:"blob",headers:{Accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}}),h=new Date,o=h.getFullYear(),l=String(h.getMonth()+1).padStart(2,"0"),w=String(h.getDate()).padStart(2,"0"),D=String(h.getHours()).padStart(2,"0"),V=String(h.getMinutes()).padStart(2,"0"),k=String(h.getSeconds()).padStart(2,"0"),r=`${o}${l}${w}${D}${V}${k}`,p=m.headers["content-disposition"],n=p?p.split("filename=")[1]:`${d} ${o} 월별 결제 통계_${r}.xlsx`,_=new Blob([m.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),f=window.URL.createObjectURL(_),v=document.createElement("a");v.href=f,v.setAttribute("download",n),document.body.appendChild(v),v.click(),document.body.removeChild(v),window.URL.revokeObjectURL(f)}catch{alert("작업 중 에러가 발생했습니다.")}}}}),P=y=>(z("data-v-8378149c"),y=y(),J(),y),q={class:"content-wrapper"},G=P(()=>t("br",null,null,-1)),K=P(()=>t("strong",null,"DCB :",-1)),Z=["max"],tt=P(()=>t("br",null,null,-1)),et={class:"table-wrapper"},nt=P(()=>t("th",{class:"sticky-col"},"구분",-1)),at={class:"sticky-col"},ot=P(()=>t("br",null,null,-1)),st=P(()=>t("br",null,null,-1)),lt={class:"sticky-col",colspan:"10",style:{"text-align":"center","font-weight":"bold"}},rt=P(()=>t("th",{class:"sticky-col",style:{"text-align":"center"}},"구분",-1)),ct={style:{"text-align":"center"}},ut={class:"sticky-col"},it={__name:"MonthlyPaymentStatistics",setup(y){const g=X(),{contents:s}=N(g),d=r=>({totalAmount:"결제 금액 합",buyAmount:"구매 금액",buyAmountPercent:"구매 비율",cancelAmount:"취소 금액",cancelAmountPercent:"취소 비율",refundAmount:"환불 금액",refundAmountPercent:"환불 비율",paymentCount:"결제 건수 합",buyCount:"구매 건수",buyCountPercent:"구매 건수 비율",cancelCount:"취소 건수",cancelCountPercent:"취소 건수 비율",refundCount:"환불 건수",refundCountPercent:"환불 건수 비율",buyAmountAverage:"건당 평균 구매 금액",cancelAmountAverage:"건당 평균 취소 금액",refundAmountAverage:"건당 평균 환불 금액"})[r]||r,m=()=>new Date().getFullYear(),h=R(m());let o=R(m()),l=R([]);const w=()=>{if(l.value.length===0){alert("조회할 DCB를 선택해주세요.");return}if(o.value===""){alert("조회할 연도를 선택해주세요.");return}const r=m();if(o.value>r){alert("선택한 연도의 데이터가 아직 생성되지 않았습니다.");return}D()},D=async()=>{await g.getStatistics(l.value,o.value)},V=()=>{if(l.value.length===0){alert("조회할 DCB를 선택해주세요.");return}if(o.value===""){alert("조회할 달을 선택해주세요.");return}const r=m();if(o.value>r){alert("선택한 연도의 데이터가 아직 생성되지 않았습니다.");return}k()},k=async()=>{await g.exportData(l.value,o.value)};return(r,p)=>(e(),a("div",q,[G,b(Q,{align:"center",justify:"end"},{default:c(()=>[b(S,{cols:"auto"},{default:c(()=>[K]),_:1}),(e(!0),a(i,null,A(u(T),n=>(e(),B(S,{cols:"auto"},{default:c(()=>[b(W,{label:n,value:n,modelValue:u(l),"onUpdate:modelValue":p[0]||(p[0]=_=>U(l)?l.value=_:l=_)},null,8,["label","value","modelValue"])]),_:2},1024))),256)),b(S,{cols:"auto"},{default:c(()=>[E(t("input",{type:"year","onUpdate:modelValue":p[1]||(p[1]=n=>U(o)?o.value=n:o=n),max:h.value},null,8,Z),[[H,u(o)]])]),_:1}),b(S,{cols:"auto"},{default:c(()=>[b(L,{variant:"elevated",onClick:w},{default:c(()=>[x(" 조회 ")]),_:1})]),_:1}),b(S,{cols:"auto"},{default:c(()=>[b(L,{variant:"elevated",onClick:V},{default:c(()=>[x(" 엑셀 ")]),_:1})]),_:1})]),_:1}),tt,t("div",et,[u(s).length===0?(e(),B($,{key:0,class:"table-container"},{default:c(()=>[x(" 데이터가 없습니다. ")]),_:1})):(e(),B($,{key:1,class:"table-container"},{default:c(()=>[t("thead",null,[t("tr",null,[nt,(e(!0),a(i,null,A(u(s).total.statMonth,n=>(e(),a("th",null,C(n),1))),256))])]),t("tbody",null,[(e(),a(i,null,A(["totalAmount","buyAmount","buyAmountPercent","cancelAmount","cancelAmountPercent","refundAmount","refundAmountPercent","paymentCount","buyCount","buyCountPercent","cancelCount","cancelCountPercent","refundCount","refundCountPercent","buyAmountAverage","cancelAmountAverage","refundAmountAverage"],(n,_)=>t("tr",{class:M("section-"+(_%3+1))},[t("td",at,C(d(n)),1),(e(!0),a(i,null,A(u(s).total[n],f=>(e(),a("td",null,C(f),1))),256))],2)),64)),(e(!0),a(i,null,A(u(T),(n,_)=>(e(),a(i,{key:_},[u(s)[n]?(e(),a(i,{key:0},[ot,x(),st,t("tr",null,[t("td",lt,C(n)+" 통계",1)]),t("tr",null,[rt,(e(!0),a(i,null,A(u(s)[n].statMonth,f=>(e(),a("th",ct,C(f),1))),256))]),(e(),a(i,null,A(["totalAmount","buyAmount","buyAmountPercent","cancelAmount","cancelAmountPercent","refundAmount","refundAmountPercent","paymentCount","buyCount","buyCountPercent","cancelCount","cancelCountPercent","refundCount","refundCountPercent","buyAmountAverage","cancelAmountAverage","refundAmountAverage"],(f,v)=>t("tr",{class:M("section-"+(v%3+1))},[t("td",ut,C(d(f)),1),(e(!0),a(i,null,A(u(s)[n][f],I=>(e(),a("td",null,C(I),1))),256))],2)),64))],64)):O("",!0)],64))),128))])]),_:1}))])]))}},gt=F(it,[["__scopeId","data-v-8378149c"]]);export{gt as default};
