import{U as G,W as H,$ as L,e as P,c as y,d as n,w as a,J as v,a as t,o as V,H as r,R,D as N,X as J,Y as M,F as O,g as $,t as c,n as W}from"./index-BNrJ-Dvj.js";import{a as z}from"./axios-B4uVmeYG.js";import{v as F}from"./validation-C0rubo8V.js";import{V as Q}from"./VCard-BJRkKJ14.js";import{V as K,a as g}from"./VField-Cziex-qH.js";import{V as Z}from"./VTable-BLQw7MbS.js";import{V as j}from"./VTextField-Cyw_K3aJ.js";import{V as q}from"./VSelect-KAzCz1Mg.js";import"./VCardTitle-BPFYhZvz.js";import"./createSimpleFunctional-C8sGjN9l.js";import"./VAvatar-TsXOFCQi.js";import"./VImg-Djp65FB0.js";import"./index-BPvLzGhW.js";import"./VGrid-DeylvMMY.js";import"./VMenu-d9ONUfxi.js";import"./VDivider-BD2uBEGn.js";import"./VOverlay-DUP5QlJ3.js";import"./VCheckboxBtn-B0yZRWh3.js";const tt=G("main",{state:()=>({contents:[],total:"",pageSize:10,currentPage:1}),actions:{async getContents(w,h,x,b,C=1){const p="http://localhost:9999/reconciliation/error/sdcb";try{const l=await z.get(p,{params:{dcb:w,month:h,case:x,ctn:b,page:C,pageSize:this.pageSize}});this.contents=l.data.responsePage.content,this.total=l.data.responsePage.totalElements,this.currentPage=l.data.responsePage.number+1}catch{alert("작업 중 에러가 발생했습니다.")}},async exportData(w,h,x,b){const C="http://localhost:9999/reconciliation/error/sdcb/excel";try{const p=await z.get(C,{params:{dcb:w,month:h,case:x,ctn:b},responseType:"blob",headers:{Accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}}),l=new Date,k=l.getFullYear(),m=String(l.getMonth()+1).padStart(2,"0"),D=String(l.getDate()).padStart(2,"0"),T=String(l.getHours()).padStart(2,"0"),A=String(l.getMinutes()).padStart(2,"0"),U=String(l.getSeconds()).padStart(2,"0"),E=`${k}${m}${D}${T}${A}${U}`,o=p.headers["content-disposition"],s=o?o.split("filename=")[1]:`${w} ${m} 대사 오류_${E}.xlsx`,S=new Blob([p.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),d=window.URL.createObjectURL(S),_=document.createElement("a");_.href=d,_.setAttribute("download",s),document.body.appendChild(_),_.click(),document.body.removeChild(_),window.URL.revokeObjectURL(d)}catch{alert("작업 중 에러가 발생했습니다.")}}}}),et={class:"content-wrapper"},lt=t("br",null,null,-1),nt=t("div",null,[t("table",null,[t("thead",null,[t("tr",null,[t("th",null,"SKP(A)"),t("th",null,"LGU+(B)"),t("th",null,"구분"),t("th",null,"비고")])]),t("tbody",null,[t("tr",null,[t("td",null,"O"),t("td",null,"X"),t("td",null,"Case1"),t("td")]),t("tr",null,[t("td",null,"X"),t("td",null,"O"),t("td",null,"Case2"),t("td")]),t("tr",null,[t("td",null,"O"),t("td",null,"O"),t("td",null,"Case3"),t("td",null,"동일 RequestId에 대해 Column 정보 불일치한 경우")])])])],-1),at=t("br",null,null,-1),ot=t("br",null,null,-1),st=t("br",null,null,-1),ut=t("br",null,null,-1),rt=["max"],it=t("br",null,null,-1),dt=t("thead",null,[t("tr",null,[t("th",null,"번호"),t("th",null,"CASE"),t("th",null,"Request Id"),t("th",null,"Transaction Id"),t("th",null,"결제 유형"),t("th",null,"결제 금액"),t("th",null,"처리 시간"),t("th",null,"사유"),t("th",null,"처리 방법")])],-1),ct={key:0},pt=t("td",{colspan:"9",style:{"text-align":"center"}},"데이터가 없습니다.",-1),mt=[pt],ht={class:"pagination"},_t=t("br",null,null,-1),ft=t("br",null,null,-1),vt=["disabled"],gt=t("b",null,"이전",-1),bt=[gt],Ct=["onClick"],St=["disabled"],yt=t("b",null,"다음",-1),Vt=[yt],Kt={__name:"Reconciliation-Error-SDCB",setup(w){const h=tt(),{keyword:x,contents:b,total:C,pageSize:p,currentPage:l}=H(h),k=()=>{const i=new Date,u=i.getFullYear(),e=String(i.getMonth()+1).padStart(2,"0");return`${u}-${e}`},m=L(()=>C.value?Math.ceil(C.value/p.value):0),D=i=>{if(s.value===""||s.value===null)return alert("DCB를 선택해주세요."),!1;if(o.value.trim().length===0)return alert("CTN을 입력해주세요."),!1;i>=1&&i<=m.value&&h.getContents(s.value,o.value,i)},T=()=>{l.value>1&&D(l.value-1)},A=()=>{l.value<m.value&&D(l.value+1)},U=()=>{if(s.value===""||s.value===null)return alert("DCB를 선택해주세요."),!1;if(f.value===""){alert("조회할 달을 선택해주세요.");return}const i=k();if(f.value>i){alert("선택한 달의 데이터가 아직 생성되지 않았습니다.");return}if(d.value.length===0){alert("조회할 CASE를 선택해주세요.");return}if(F(o.value))return alert(F(o.value)),!1;E()},E=()=>{h.getContents(s.value,f.value,d.value,o.value,pageNumber)};let o=x,s=P("SDCB"),S=P("선택하세요"),d=P("");const _=L(()=>["CASE1","CASE2","CASE3"]),X=["선택하세요","청구 내역 생성(자동)","청구 내역 취소(자동)","청구 취소(자동) 후 SKP에 재전송 요청","SKP에 구매 이력 생성 요청","SKP에 구매 취소 요청"],Y=P(k());let f=P(k());return(i,u)=>(V(),y("div",et,[lt,n(Q,{class:"p-4 mb-4",outlined:""},{default:a(()=>[nt]),_:1}),at,v(),ot,v(),st,v(),ut,n(K,{align:"center",justify:"end"},{default:a(()=>[n(g,{cols:"auto"},{default:a(()=>[n(j,{class:"min-width-select",label:"DCB",modelValue:r(s),"onUpdate:modelValue":u[0]||(u[0]=e=>R(s)?s.value=e:s=e),variant:"outlined",readonly:""},null,8,["modelValue"])]),_:1}),n(g,{cols:"auto"},{default:a(()=>[N(t("input",{type:"month","onUpdate:modelValue":u[1]||(u[1]=e=>R(f)?f.value=e:f=e),max:Y.value},null,8,rt),[[J,r(f)]])]),_:1}),n(g,{cols:"auto"},{default:a(()=>[n(q,{class:"min-width-select",clearable:"",items:_.value,modelValue:r(d),"onUpdate:modelValue":u[2]||(u[2]=e=>R(d)?d.value=e:d=e),label:"CASE",variant:"outlined"},null,8,["items","modelValue"])]),_:1}),n(g,{cols:"auto"},{default:a(()=>[n(j,{class:"min-width-input",modelValue:r(o),"onUpdate:modelValue":u[3]||(u[3]=e=>R(o)?o.value=e:o=e),label:"CTN",variant:"outlined"},null,8,["modelValue"])]),_:1}),n(g,{cols:"auto"},{default:a(()=>[n(M,{variant:"elevated",onClick:U},{default:a(()=>[v(" 조회 ")]),_:1})]),_:1}),n(g,{cols:"auto"},{default:a(()=>[n(M,{variant:"elevated",onClick:i.validateAndExportData},{default:a(()=>[v(" 엑셀 ")]),_:1},8,["onClick"])]),_:1})]),_:1}),it,n(Z,{class:"table-container"},{default:a(()=>[t("div",null,[t("table",null,[dt,t("tbody",null,[r(b).length===0?(V(),y("tr",ct,mt)):(V(!0),y(O,{key:1},$(r(b),(e,B)=>(V(),y("tr",null,[t("td",null,c((r(l)-1)*r(p)+B+1),1),t("td",null,c(e.case),1),t("td",null,c(e.requestId),1),t("td",null,c(e.transactionId),1),t("td",null,c(e.type),1),t("td",null,c(e.price),1),t("td",null,c(e.time),1),t("td",null,c(e.reason),1),t("td",null,[n(q,{items:X,label:"선택하세요",modelValue:r(S),"onUpdate:modelValue":u[4]||(u[4]=I=>R(S)?S.value=I:S=I),outlined:""},null,8,["modelValue"])])]))),256))])]),t("div",ht,[_t,ft,n(K,{align:"center",justify:"center"},{default:a(()=>[n(g,{cols:"auto"},{default:a(()=>[t("button",{onClick:T,disabled:r(l)===1},bt,8,vt),v("   "),(V(!0),y(O,null,$(m.value,e=>(V(),y("button",{key:e,onClick:B=>D(e),class:W({active:e===r(l)})},c(e),11,Ct))),128)),v("   "),t("button",{onClick:A,disabled:r(l)===m.value||m.value<1},Vt,8,St)]),_:1})]),_:1})])])]),_:1})]))}};export{Kt as default};
