import{U as Y,W as q,e as x,$ as G,c as g,d as e,w as a,a as t,H as o,F as z,g as R,o as V,R as F,Y as D,J as v,t as h,D as O,a1 as Q,n as X}from"./index-BNrJ-Dvj.js";import{a as T}from"./axios-B4uVmeYG.js";import{a as Z,v as A}from"./validation-C0rubo8V.js";import{m as tt,f as et,c as lt}from"./masking-BVJ2ul4w.js";import{d as at}from"./dcb-DFDBfy1j.js";import{V as S,a as b}from"./VField-Cziex-qH.js";import{V as ot}from"./VDialog-CFwR0aSU.js";import{V as nt}from"./VSelect-KAzCz1Mg.js";import{V as L}from"./VTextField-Cyw_K3aJ.js";import{V as st,a as ut,b as rt}from"./VCard-BJRkKJ14.js";import{V as it}from"./VCardTitle-BPFYhZvz.js";import{V as ct}from"./VSpacer-BAKhUge0.js";import"./VGrid-DeylvMMY.js";import"./index-BPvLzGhW.js";import"./VOverlay-DUP5QlJ3.js";import"./VMenu-d9ONUfxi.js";import"./createSimpleFunctional-C8sGjN9l.js";import"./VAvatar-TsXOFCQi.js";import"./VImg-Djp65FB0.js";import"./VDivider-BD2uBEGn.js";import"./VCheckboxBtn-B0yZRWh3.js";const dt=Y("main",{state:()=>({dcb:"",contents:[],total:"",pageSize:10,currentPage:1}),actions:{async getContents(m,r,i=1){const _="http://localhost:9999/block/ctn";try{const n=await T.get(_,{params:{dcb:m,ctn:r,page:i,pageSize:this.pageSize}});this.contents=n.data.responsePage.content,this.total=n.data.responsePage.totalElements,this.currentPage=n.data.responsePage.number+1,this.dcb=m}catch{alert("작업 중 에러가 발생했습니다.")}},async deleteContents(m,r,i){const _="http://localhost:9999/block/ctn";try{await T.delete(_,{data:{dcb:m,ctns:i}});const n=this.total-i.length,f=Math.ceil(n/this.pageSize),c=this.currentPage>f?f:this.currentPage;this.getContents(m,r,c)}catch{alert("작업 중 에러가 발생했습니다.")}},async createContent(m,r,i){const _="http://localhost:9999/block/ctn";try{await T.post(_,{dcb:m,ctn:i,mbrId:"동욱스"});const n=this.total+1,f=Math.ceil(n/this.pageSize);this.getContents(m,r,f)}catch{alert("작업 중 에러가 발생했습니다.")}}}}),vt={class:"content-wrapper"},mt=t("br",null,null,-1),_t=t("br",null,null,-1),ft={class:"table-container"},pt=t("thead",null,[t("tr",null,[t("th",null,"번호"),t("th",null,"선택"),t("th",null,"CTN"),t("th",null,"등록자"),t("th",null,"등록일자")])],-1),ht={key:0},Ct=t("td",{colspan:"5",style:{"text-align":"center"}},"데이터가 없습니다.",-1),gt=[Ct],Vt=["value"],bt={class:"masked"},kt={class:"original"},yt={class:"masked"},Pt={class:"original"},xt={class:"pagination"},Dt=t("br",null,null,-1),Bt=t("br",null,null,-1),wt=["disabled"],Tt=t("b",null,"이전",-1),St=[Tt],It=["onClick"],Ut=["disabled"],zt=t("b",null,"다음",-1),Rt=[zt],Ft=t("br",null,null,-1),At=t("br",null,null,-1),oe={__name:"BlockCtn",setup(m){const r=dt(),{dcb:i,contents:_,total:n,pageSize:f,currentPage:c}=q(r),B=x(!1),C=x({ctn:""}),k=x(""),p=x([]);let s=i,d=x("");const y=G(()=>n.value?Math.ceil(n.value/f.value):0),w=P=>{if(s.value===""||s.value===null)return alert("DCB를 선택해주세요."),!1;P>=1&&P<=y.value&&(r.getContents(s.value,d.value,P),p.value=[])},M=()=>{c.value>1&&w(c.value-1)},N=()=>{c.value<y.value&&w(c.value+1)},j=()=>{if(s.value===""||s.value===null)return alert("DCB를 선택해주세요."),!1;if(A(d.value))return alert(A(d.value)),!1;r.getContents(s.value,d.value,c.value),p.value=[]},E=()=>{if(s.value===""||s.value===null)return alert("DCB를 선택해주세요."),!1;if(p.value.length===0){alert("삭제할 CTN을 선택해주세요.");return}confirm("정말 삭제하시겠습니까?")&&r.deleteContents(s.value,d.value,p.value).then(()=>{p.value=[]})},$=()=>{H(),B.value=!0},I=()=>{B.value=!1},H=()=>{C.value.ctn="",k.value=""},J=()=>s.value===""||s.value===null?(alert("DCB를 선택해주세요."),!1):(C.value.ctn||(k.value="CTN은 12자리 이하의 숫자여야 합니다."),!k.value),K=()=>{J()&&(r.createContent(s.value,d.value,C.value.ctn),I())};return(P,u)=>(V(),g("div",vt,[mt,e(S,{align:"center",justify:"end"},{default:a(()=>[e(b,{cols:"auto"},{default:a(()=>[e(nt,{class:"min-width-select",clearable:"",label:"DCB",placeholder:"DCB",items:o(at),modelValue:o(i),"onUpdate:modelValue":u[0]||(u[0]=l=>F(i)?i.value=l:null),variant:"outlined"},null,8,["items","modelValue"])]),_:1}),e(b,{cols:"auto"},{default:a(()=>[e(L,{class:"min-width-input",modelValue:o(d),"onUpdate:modelValue":u[1]||(u[1]=l=>F(d)?d.value=l:d=l),label:"CTN",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(b,{cols:"auto"},{default:a(()=>[e(D,{variant:"elevated",onClick:j},{default:a(()=>[v(" 조회 ")]),_:1})]),_:1})]),_:1}),_t,t("div",ft,[t("div",null,[t("table",null,[pt,t("tbody",null,[o(_).length===0?(V(),g("tr",ht,gt)):(V(!0),g(z,{key:1},R(o(_),(l,U)=>(V(),g("tr",{key:l.ctn},[t("td",null,h((o(c)-1)*o(f)+U+1),1),t("td",null,[O(t("input",{type:"checkbox","onUpdate:modelValue":u[2]||(u[2]=W=>p.value=W),value:l.ctn},null,8,Vt),[[Q,p.value]])]),t("td",null,[t("span",bt,h(o(tt)(l.ctn)),1),t("span",kt,h(o(et)(l.ctn)),1)]),t("td",null,[t("span",yt,h(o(lt)(l.mbrId)),1),t("span",Pt,h(l.mbrId),1)]),t("td",null,h(l.regDt),1)]))),128))])]),t("div",xt,[Dt,Bt,e(S,{align:"center",justify:"end"},{default:a(()=>[e(b,{cols:"auto"},{default:a(()=>[t("button",{onClick:M,disabled:o(c)===1},St,8,wt),v("   "),(V(!0),g(z,null,R(y.value,l=>(V(),g("button",{key:l,onClick:U=>w(l),class:X({active:l===o(c)})},h(l),11,It))),128)),v("   "),t("button",{onClick:N,disabled:o(c)===y.value||y.value<1},Rt,8,Ut)]),_:1})]),_:1}),e(S,{align:"center",justify:"end"},{default:a(()=>[e(b,{cols:"auto"},{default:a(()=>[e(D,{onClick:E},{default:a(()=>[v(" 삭제 ")]),_:1})]),_:1}),e(b,{cols:"auto"},{default:a(()=>[e(D,{variant:"elevated",onClick:$},{default:a(()=>[v(" 등록 ")]),_:1})]),_:1})]),_:1})])])]),e(ot,{modelValue:B.value,"onUpdate:modelValue":u[5]||(u[5]=l=>B.value=l),"max-width":"600px"},{default:a(()=>[e(st,null,{default:a(()=>[e(it,{class:"text-h5"},{default:a(()=>[v("차단 CTN 등록")]),_:1}),v(),Ft,e(ut,null,{default:a(()=>[e(L,{label:"CTN",modelValue:C.value.ctn,"onUpdate:modelValue":u[3]||(u[3]=l=>C.value.ctn=l),"error-messages":k.value,onBlur:u[4]||(u[4]=l=>k.value=o(Z)(C.value.ctn))},null,8,["modelValue","error-messages"]),v(),At]),_:1}),e(rt,null,{default:a(()=>[e(ct),e(D,{color:"blue darken-1",variant:"outlined",text:"",onClick:I},{default:a(()=>[v("취소")]),_:1}),e(D,{color:"blue darken-1",variant:"outlined",text:"",onClick:K},{default:a(()=>[v("저장")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};export{oe as default};
