import{U as N,_ as F,W as E,e as R,c as a,d as _,w as u,a as e,H as i,b as B,o as n,F as d,g as A,R as U,D as Y,X as H,Y as $,J as x,t as C,n as L,h as O,P as z,Q as G}from"./index-B8EbGMN3.js";import{d as M}from"./dcb-DFDBfy1j.js";import{a as T}from"./axios-B4uVmeYG.js";import{V as J,a as P}from"./VInput-msPG-MP_.js";import{V as I}from"./VTable-QS9nLRnj.js";import{V as Q}from"./VCheckbox-DfbeVHEU.js";import"./VGrid-D8xKyB2U.js";import"./transition-h0L7ZsHG.js";import"./VCheckboxBtn-BDq1Ohb6.js";const W=N("main",{state:()=>({contents:[]}),actions:{async getStatistics(f,g){const r="http://localhost:8080/payment/day";try{const m=f.join(","),p=await T.get(r,{params:{dcbs:m,month:g}});this.contents=p.data.mapResult}catch{alert("작업 중 에러가 발생했습니다.")}},async exportData(f,g){const r="http://localhost:8080/payment/day/excel";try{const m=f.join(","),p=await T.get(r,{params:{dcbs:m,month:g},responseType:"blob",headers:{Accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}}),h=new Date,o=h.getFullYear(),l=String(h.getMonth()+1).padStart(2,"0"),D=String(h.getDate()).padStart(2,"0"),w=String(h.getHours()).padStart(2,"0"),V=String(h.getMinutes()).padStart(2,"0"),k=String(h.getSeconds()).padStart(2,"0"),s=`${o}${l}${D}${w}${V}${k}`,c=p.headers["content-disposition"],t=c?c.split("filename=")[1]:`${m} ${l} 일별 결제 통계_${s}.xlsx`,b=new Blob([p.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),y=window.URL.createObjectURL(b),v=document.createElement("a");v.href=y,v.setAttribute("download",t),document.body.appendChild(v),v.click(),document.body.removeChild(v),window.URL.revokeObjectURL(y)}catch{alert("작업 중 에러가 발생했습니다.")}}}}),S=f=>(z("data-v-ebb15a22"),f=f(),G(),f),X={class:"content-wrapper"},q=S(()=>e("br",null,null,-1)),K=S(()=>e("strong",null,"DCB :",-1)),Z=["max"],tt=S(()=>e("br",null,null,-1)),et={class:"table-wrapper"},nt=S(()=>e("th",{class:"sticky-col"},"구분",-1)),at={class:"sticky-col"},ot=S(()=>e("br",null,null,-1)),st=S(()=>e("br",null,null,-1)),lt={class:"sticky-col",colspan:"10",style:{"text-align":"center","font-weight":"bold"}},rt=S(()=>e("th",{class:"sticky-col",style:{"text-align":"center"}},"구분",-1)),ct={style:{"text-align":"center"}},ut={class:"sticky-col"},it={__name:"DailyPaymentStatistics",setup(f){const g=W(),{contents:r}=E(g),m=s=>({totalAmount:"결제 금액 합",buyAmount:"구매 금액",buyAmountPercent:"구매 비율",cancelAmount:"취소 금액",cancelAmountPercent:"취소 비율",refundAmount:"환불 금액",refundAmountPercent:"환불 비율",paymentCount:"결제 건수 합",buyCount:"구매 건수",buyCountPercent:"구매 건수 비율",cancelCount:"취소 건수",cancelCountPercent:"취소 건수 비율",refundCount:"환불 건수",refundCountPercent:"환불 건수 비율",buyAmountAverage:"건당 평균 구매 금액",cancelAmountAverage:"건당 평균 취소 금액",refundAmountAverage:"건당 평균 환불 금액"})[s]||s,p=()=>{const s=new Date,c=s.getFullYear(),t=String(s.getMonth()+1).padStart(2,"0");return`${c}-${t}`},h=R(p());let o=R(p()),l=R([]);const D=()=>{if(l.value.length===0){alert("조회할 DCB를 선택해주세요.");return}if(o.value===""){alert("조회할 달을 선택해주세요.");return}const s=p();if(o.value>s){alert("선택한 달의 데이터가 아직 생성되지 않았습니다.");return}w()},w=async()=>{await g.getStatistics(l.value,o.value)},V=()=>{if(l.value.length===0){alert("조회할 DCB를 선택해주세요.");return}if(o.value===""){alert("조회할 달을 선택해주세요.");return}const s=p();if(o.value>s){alert("선택한 달의 데이터가 아직 생성되지 않았습니다.");return}k()},k=async()=>{await g.exportData(l.value,o.value)};return(s,c)=>(n(),a("div",X,[q,_(J,{align:"center",justify:"end"},{default:u(()=>[_(P,{cols:"auto"},{default:u(()=>[K]),_:1}),(n(!0),a(d,null,A(i(M),t=>(n(),B(P,{cols:"auto"},{default:u(()=>[_(Q,{label:t,value:t,modelValue:i(l),"onUpdate:modelValue":c[0]||(c[0]=b=>U(l)?l.value=b:l=b)},null,8,["label","value","modelValue"])]),_:2},1024))),256)),_(P,{cols:"auto"},{default:u(()=>[Y(e("input",{type:"month","onUpdate:modelValue":c[1]||(c[1]=t=>U(o)?o.value=t:o=t),max:h.value},null,8,Z),[[H,i(o)]])]),_:1}),_(P,{cols:"auto"},{default:u(()=>[_($,{variant:"elevated",onClick:D},{default:u(()=>[x(" 조회 ")]),_:1})]),_:1}),_(P,{cols:"auto"},{default:u(()=>[_($,{variant:"elevated",onClick:V},{default:u(()=>[x(" 엑셀 ")]),_:1})]),_:1})]),_:1}),tt,e("div",et,[i(r).length===0?(n(),B(I,{key:0,class:"table-container"},{default:u(()=>[x(" 데이터가 없습니다. ")]),_:1})):(n(),B(I,{key:1,class:"table-container"},{default:u(()=>[e("thead",null,[e("tr",null,[nt,(n(!0),a(d,null,A(i(r).total.statDay,t=>(n(),a("th",null,C(t),1))),256))])]),e("tbody",null,[(n(),a(d,null,A(["totalAmount","buyAmount","buyAmountPercent","cancelAmount","cancelAmountPercent","refundAmount","refundAmountPercent","paymentCount","buyCount","buyCountPercent","cancelCount","cancelCountPercent","refundCount","refundCountPercent","buyAmountAverage","cancelAmountAverage","refundAmountAverage"],(t,b)=>e("tr",{class:L("section-"+(b%3+1))},[e("td",at,C(m(t)),1),(n(!0),a(d,null,A(i(r).total[t],y=>(n(),a("td",null,C(y),1))),256))],2)),64)),(n(!0),a(d,null,A(i(M),(t,b)=>(n(),a(d,{key:b},[i(r)[t]?(n(),a(d,{key:0},[ot,x(),st,e("tr",null,[e("td",lt,C(t)+" 통계",1)]),e("tr",null,[rt,(n(!0),a(d,null,A(i(r)[t].statDay,y=>(n(),a("th",ct,C(y),1))),256))]),(n(),a(d,null,A(["totalAmount","buyAmount","buyAmountPercent","cancelAmount","cancelAmountPercent","refundAmount","refundAmountPercent","paymentCount","buyCount","buyCountPercent","cancelCount","cancelCountPercent","refundCount","refundCountPercent","buyAmountAverage","cancelAmountAverage","refundAmountAverage"],(y,v)=>e("tr",{class:L("section-"+(v%3+1))},[e("td",ut,C(m(y)),1),(n(!0),a(d,null,A(i(r)[t][y],j=>(n(),a("td",null,C(j),1))),256))],2)),64))],64)):O("",!0)],64))),128))])]),_:1}))])]))}},gt=F(it,[["__scopeId","data-v-ebb15a22"]]);export{gt as default};
