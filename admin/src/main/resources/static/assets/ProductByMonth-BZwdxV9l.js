import{U as H,W as O,$ as z,e as F,c,d as n,w as u,a as t,o as m,H as s,R as $,D as G,X as J,Y as j,J as D,F as P,g as B,t as v,n as W}from"./index-B8EbGMN3.js";import{a as E}from"./axios-B4uVmeYG.js";import{d as X}from"./dcb-DFDBfy1j.js";import{V as N,a as x}from"./VInput-msPG-MP_.js";import{V as q}from"./VTable-QS9nLRnj.js";import{V as K}from"./VSelect-CZOfT56l.js";import{V as Q}from"./VTextField-Ujn_yGZZ.js";import"./VGrid-D8xKyB2U.js";import"./transition-h0L7ZsHG.js";import"./forwardRefs-DWGaNmQL.js";import"./VMenu-BRgnxf6I.js";import"./createSimpleFunctional-DwNSd_ti.js";import"./VAvatar-IsnjnCc2.js";import"./VImg-BNBQc3z5.js";import"./index-Qv1F-OC0.js";import"./VDivider-DJKyB90Z.js";import"./VOverlay-ColyBhV7.js";import"./VCheckboxBtn-BDq1Ohb6.js";import"./VField-8s2H7kOf.js";const Z=H("main",{state:()=>({dcb:"",keyword:"",contents:[],total:"",pageSize:10,currentPage:1}),actions:{async getContents(g,p,y,C=1){const h="http://localhost:8080/product/month";try{const l=await E.get(h,{params:{dcb:g,year:p,itemName:y,page:C,pageSize:this.pageSize}});this.contents=l.data.responsePage.content,this.total=l.data.responsePage.totalElements,this.currentPage=l.data.responsePage.number+1,this.dcb=g,this.keyword=y}catch{alert("작업 중 에러가 발생했습니다.")}},async exportData(g,p,y){const C="http://localhost:8080/product/month/excel";try{const h=await E.get(C,{params:{dcb:g,year:p,itemName:y},responseType:"blob",headers:{Accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}}),l=new Date,k=l.getFullYear(),r=String(l.getMonth()+1).padStart(2,"0"),f=String(l.getDate()).padStart(2,"0"),w=String(l.getHours()).padStart(2,"0"),R=String(l.getMinutes()).padStart(2,"0"),T=String(l.getSeconds()).padStart(2,"0"),b=`${k}${r}${f}${w}${R}${T}`,S=h.headers["content-disposition"],U=S?S.split("filename=")[1]:`${g} ${k} 상품 월별 목록_${b}.xlsx`,Y=new Blob([h.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),V=window.URL.createObjectURL(Y),a=document.createElement("a");a.href=V,a.setAttribute("download",U),document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(V)}catch{alert("작업 중 에러가 발생했습니다.")}}}}),tt={class:"content-wrapper"},et=t("br",null,null,-1),at=["max"],lt=t("br",null,null,-1),ot=t("th",null,"번호",-1),nt=t("th",null,"판매자명",-1),st=t("th",null,"상품명",-1),rt=t("th",null,"Total",-1),it=t("th",null,"비율",-1),ut={key:0},dt=t("td",{colspan:"17",style:{"text-align":"center"}},"데이터가 없습니다.",-1),ct=[dt],mt={class:"pagination"},pt=t("br",null,null,-1),ht=t("br",null,null,-1),_t=["disabled"],vt=t("b",null,"이전",-1),ft=[vt],gt=["onClick"],yt=["disabled"],bt=t("b",null,"다음",-1),xt=[bt],Et={__name:"ProductByMonth",setup(g){const p=Z(),{dcb:y,keyword:C,contents:h,total:l,pageSize:k,currentPage:r}=O(p),f=z(()=>l.value?Math.ceil(l.value/k.value):0),w=d=>{if(o.value===""||o.value===null)return alert("DCB를 선택해주세요."),!1;d>=1&&d<=f.value&&p.getContents(o.value,i.value,a.value,d)},R=()=>{r.value>1&&w(r.value-1)},T=()=>{r.value<f.value&&w(r.value+1)},b=()=>new Date().getFullYear(),S=()=>{if(o.value===""||o.value===null)return alert("DCB를 선택해주세요."),!1;if(i.value===""){alert("조회할 연도를 선택해주세요.");return}const d=b();if(i.value>d){alert("선택한 연도의 데이터가 아직 생성되지 않았습니다.");return}a.value.trim().length===0&&(a.value=""),U()},U=()=>{p.getContents(o.value,i.value,a.value,r.value)},Y=()=>{if(o.value===""||o.value===null)return alert("DCB를 선택해주세요."),!1;if(i.value===""){alert("조회할 연도를 선택해주세요.");return}const d=b();if(i.value>d){alert("선택한 연도의 데이터가 아직 생성되지 않았습니다.");return}a.value.trim().length===0&&(a.value=""),V()},V=()=>{p.exportData(o.value,i.value,a.value)};let a=C,o=y,i=F(b()),I=F(b());const A=z(()=>Array.from({length:12},(d,_)=>_+1));return(d,_)=>(m(),c("div",tt,[et,n(N,{align:"center",justify:"end"},{default:u(()=>[n(x,{cols:"auto"},{default:u(()=>[n(K,{class:"min-width-select",clearable:"",label:"DCB",placeholder:"DCB",items:s(X),modelValue:s(o),"onUpdate:modelValue":_[0]||(_[0]=e=>$(o)?o.value=e:o=e),variant:"outlined"},null,8,["items","modelValue"])]),_:1}),n(x,{cols:"auto"},{default:u(()=>[G(t("input",{type:"year","onUpdate:modelValue":_[1]||(_[1]=e=>$(i)?i.value=e:i=e),max:s(I)},null,8,at),[[J,s(i)]])]),_:1}),n(x,{cols:"auto"},{default:u(()=>[n(Q,{class:"min-width-input",modelValue:s(a),"onUpdate:modelValue":_[2]||(_[2]=e=>$(a)?a.value=e:a=e),label:"상품명",variant:"outlined"},null,8,["modelValue"])]),_:1}),n(x,{cols:"auto"},{default:u(()=>[n(j,{variant:"elevated",onClick:S},{default:u(()=>[D(" 조회 ")]),_:1})]),_:1}),n(x,{cols:"auto"},{default:u(()=>[n(j,{variant:"elevated",onClick:Y},{default:u(()=>[D(" 엑셀 ")]),_:1})]),_:1})]),_:1}),lt,n(q,{class:"table-container"},{default:u(()=>[t("div",null,[t("table",null,[t("thead",null,[t("tr",null,[ot,nt,st,rt,it,(m(!0),c(P,null,B(A.value,e=>(m(),c("th",{key:e},v(e)+"월",1))),128))])]),t("tbody",null,[s(h).length===0?(m(),c("tr",ut,ct)):(m(!0),c(P,{key:1},B(s(h),(e,L)=>(m(),c("tr",{key:e.itemsalesNm},[t("td",null,v((s(r)-1)*s(k)+L+1),1),t("td",null,v(e.merchantName),1),t("td",null,v(e.itemName),1),t("td",null,v(e.total),1),t("td",null,v(e.percent),1),(m(!0),c(P,null,B(A.value,M=>(m(),c("td",{key:M},v(e.monthlySales[M-1]||0),1))),128))]))),128))])]),t("div",mt,[pt,ht,n(N,{align:"center",justify:"center"},{default:u(()=>[n(x,{cols:"auto"},{default:u(()=>[t("button",{onClick:R,disabled:s(r)===1},ft,8,_t),D("   "),(m(!0),c(P,null,B(f.value,e=>(m(),c("button",{key:e,onClick:L=>w(e),class:W({active:e===s(r)})},v(e),11,gt))),128)),D("   "),t("button",{onClick:T,disabled:s(r)===f.value||f.value<1},xt,8,yt)]),_:1})]),_:1})])])]),_:1})]))}};export{Et as default};
